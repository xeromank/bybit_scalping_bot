# V3 ì „ëµ ê°œë°œ ì§„í–‰ ìƒí™©

**ì‘ì„±ì¼**: 2025-10-22 08:20:24
**ë²„ì „**: V3 Strategy Development Log

---

## ğŸ“‹ ëª©í‘œ

ë°´ë“œì›Œí‚¹ ê°ì§€ ê¸°ë°˜ **ì ì‘í˜• ì „ëµ** ê°œë°œ
- **ë°´ë“œì›Œí‚¹ êµ¬ê°„**: ì¶”ì„¸ ì¶”ì¢… ì§„ì…
- **ì¼ë°˜ êµ¬ê°„**: ì—­ì¶”ì„¸ í‰ê· íšŒê·€ ì§„ì…

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. ë°´ë“œì›Œí‚¹ ê°ì§€ê¸° ì ìˆ˜ ì¬ì¡°ì •

**ë³€ê²½ ì „ (100ì  ë§Œì )**:
| ì§€í‘œ | ì ìˆ˜ | ë¹„ì¤‘ |
|------|------|------|
| BB Width í™•ì¥ | 25ì  | ë‚®ìŒ |
| ì—°ì† ë°´ë“œ ë°– ìº”ë“¤ | 30ì  | ë†’ìŒ |
| MACD íˆìŠ¤í† ê·¸ë¨ | 20ì  | ì¤‘ê°„ |
| Volume ì¦ê°€ | 15ì  | ì¤‘ê°„ |
| RSI ê·¹ë‹¨ ìœ ì§€ | 10ì  | ë‚®ìŒ |

**ë³€ê²½ í›„ (105ì  ë§Œì , ì¤‘ë³µ ê°€ëŠ¥)**:
| ì§€í‘œ | ì ìˆ˜ | ë¹„ì¤‘ | ë³€ê²½ ì´ìœ  |
|------|------|------|----------|
| **BB Width í™•ì¥** | **40ì ** | **PRIMARY** | ë°´ë“œì›Œí‚¹ì˜ í•µì‹¬ ì§€í‘œ |
| **RSI ê·¹ë‹¨ ìœ ì§€** | **30ì ** | **CRITICAL** | ì¶”ì„¸ ì§€ì†ì„± í™•ì¸ |
| MACD íˆìŠ¤í† ê·¸ë¨ | 20ì  | ì¤‘ê°„ | ë°©í–¥ì„± í™•ì¸ ìœ ì§€ |
| ì—°ì† ë°´ë“œ ë°– ìº”ë“¤ | 10ì  | ë³´ì¡° | ë³´ì¡° ì§€í‘œë¡œ í•˜í–¥ |
| Volume ì¦ê°€ | 5ì  | ë³´ì¡° | ì´ˆê¸° ê°ì§€ì—ëŠ” ë¶ˆí•„ìš” |

**BB Width ì„¸ë¶€ ì ìˆ˜**:
- `ë³€í™”ìœ¨ > 3.0%`: 40ì  (ê¸‰ì¦)
- `ë³€í™”ìœ¨ > 1.0%`: 30ì  (í™•ì¥)
- `ë³€í™”ìœ¨ > 0%`: 20ì  (ë¯¸ì„¸ í™•ì¥)

**RSI ì„¸ë¶€ ì ìˆ˜**:
- `RSI > 70 or < 30`: 30ì  (ê·¹ë‹¨)
- `RSI 65-70 or 30-35 (ì¶”ì„¸ ìœ ì§€)`: 20ì  (ê·¹ë‹¨ ì˜ì—­)

**ë¦¬ìŠ¤í¬ ë ˆë²¨**:
- `ì ìˆ˜ >= 70`: HIGH (ë°´ë“œì›Œí‚¹ í™•ì •)
- `ì ìˆ˜ >= 50`: MEDIUM (ë°´ë“œì›Œí‚¹ ìœ„í—˜)
- `ì ìˆ˜ >= 30`: LOW (ì£¼ì˜)
- `ì ìˆ˜ < 30`: NONE (ì •ìƒ)

### 2. ë°´ë“œì›Œí‚¹ ë°©í–¥ íŒì • ë¡œì§ ê°œì„ 

**ë³€ê²½ ì „**:
```dart
if (currentPrice > bb.upper) direction = 'UP';
else if (currentPrice < bb.lower) direction = 'DOWN';
else direction = 'NONE';
```

**ë³€ê²½ í›„**:
```dart
if (currentPrice > bb.upper) {
  direction = 'UP';
} else if (currentPrice < bb.lower) {
  direction = 'DOWN';
} else if (risk == HIGH || risk == MEDIUM) {
  // ë°´ë“œì›Œí‚¹ ìœ„í—˜ì´ ìˆìœ¼ë©´ RSIë¡œ ë°©í–¥ íŒë‹¨
  if (rsi > 60) direction = 'UP';
  else if (rsi < 40) direction = 'DOWN';
  else direction = 'NONE';
} else {
  direction = 'NONE';
}
```

**ê°œì„ ì **: ê°€ê²©ì´ BB ë‚´ë¶€ì— ìˆì–´ë„ ë°´ë“œì›Œí‚¹ ìœ„í—˜ì´ ìˆìœ¼ë©´ RSIë¡œ ë°©í–¥ íŒë‹¨

### 3. ì „ëµë³„ ì²­ì‚° ë¡œì§ ì°¨ë³„í™”

#### ì—­ì¶”ì„¸ (Counter-Trend) ì „ëµ
- **ì§„ì…**: BB í•˜ìœ„ 20% ë˜ëŠ” ìƒìœ„ 20% ì˜ì—­
- **ìµì ˆ**: BB Middle ë„ë‹¬
- **ì†ì ˆ**: -0.5%

#### ì¶”ì„¸ ì¶”ì¢… (Trend-Following) ì „ëµ
- **ì§„ì…**: ë°´ë“œì›Œí‚¹ HIGH ë¦¬ìŠ¤í¬ + ë°©í–¥ í™•ì •
- **ìµì ˆ**:
  - 1ìˆœìœ„: BB ë°˜ëŒ€ ë°´ë“œ ë„ë‹¬ (Upper/Lower)
  - 2ìˆœìœ„: ë°´ë“œì›Œí‚¹ ì¢…ë£Œ + BB Middle ë„ë‹¬
- **ì†ì ˆ**: -5.0% (ë„“ì€ ì†ì ˆí­ìœ¼ë¡œ ì¼ì‹œì  ì¡°ì • í—ˆìš©)

**ì†ì ˆí­ í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
| ì†ì ˆí­ | ìˆ˜ìµë¥  | ë¹„ê³  |
|--------|--------|------|
| -1.0% | -0.77% | ë°´ë“œì›Œí‚¹ ì¤‘ ì¡°ê¸° ì†ì ˆ ë°œìƒ |
| -5.0% | -0.59% | âœ… ì±„íƒ (ì¼ì‹œì  ì¡°ì • í—ˆìš©) |

### 4. ê¸´ê¸‰ ì†ì ˆ ë¡œì§

**ë°˜ëŒ€ ë°©í–¥ ë°´ë“œì›Œí‚¹ ê°ì§€ ì‹œ ì¦‰ì‹œ ì²­ì‚°**:
```dart
// LONG í¬ì§€ì…˜ ì¤‘ í•˜ë½ ë°´ë“œì›Œí‚¹ HIGH ê°ì§€
if (position.currentSide == LONG &&
    bandWalking.direction == 'DOWN' &&
    bandWalking.risk == HIGH) {
  // ê¸´ê¸‰ ì†ì ˆ
}
```

---

## ğŸ“Š ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ ê¸°ê°„
- **ë‚ ì§œ**: 2025-10-19 ~ 2025-10-21 (3ì¼ê°„)
- **ì‹¬ë³¼**: ETHUSDT
- **íƒ€ì„í”„ë ˆì„**: 5ë¶„ë´‰
- **ë°ì´í„°**: 855ê°œ ìº”ë“¤

### ìµœì¢… ì„±ëŠ¥
- **ì´ ê±°ë˜**: 42ê±´
- **ìŠ¹ë¥ **: 57.1% (24ìŠ¹ 18íŒ¨)
- **ìˆ˜ìµë¥ **: -0.59%
- **ì´ˆê¸° ìê¸ˆ**: $10,000
- **ìµœì¢… ìê¸ˆ**: $9,940.82

### ê±°ë˜ ìœ í˜• ë¶„ì„
- **ì¶”ì„¸ ì¶”ì¢…**: ì•½ 20ê±´ (ë°´ë“œì›Œí‚¹ ê°ì§€ í›„ ì§„ì…)
- **ì—­ì¶”ì„¸**: ì•½ 22ê±´ (BB ê²½ê³„ì—ì„œ í‰ê· íšŒê·€)

---

## ğŸ¯ í•µì‹¬ ê°œì„  ì‚¬ë¡€

### Case 1: 14:45 ì˜ëª»ëœ SHORT ì§„ì… ì°¨ë‹¨ âœ…

**ì´ì „ (ì ìˆ˜ ì¬ì¡°ì • ì „)**:
```
14:45 - Price: 3952.94, RSI: 66.3, MACD: 5.79, Volume: 0.9x
       â†’ Score: 45 (LOW)
       â†’ ì—­ì¶”ì„¸ SHORT ì§„ì… í—ˆìš©
       â†’ ê°€ê²© ìƒìŠ¹ìœ¼ë¡œ ì†ì ˆ (-0.72%)
```

**í˜„ì¬ (ì ìˆ˜ ì¬ì¡°ì • í›„)**:
```
14:45 - Price: 3952.94, RSI: 66.3, MACD: 5.79, Volume: 0.9x
       â†’ Score: 80 (HIGH)
       â†’ ì—­ì¶”ì„¸ ì§„ì… ì°¨ë‹¨ âœ…
       â†’ ì†ì‹¤ ë°©ì§€
```

**ê°œì„  íš¨ê³¼**: Volumeì´ ë‚®ì•„ë„ BB Width + RSI + MACDë¡œ ë°´ë“œì›Œí‚¹ ì¡°ê¸° ê°ì§€

### Case 2: 14:50 ì¶”ì„¸ ì¶”ì¢… ì§„ì… ì„±ê³µ âœ…

```
14:50 - ENTRY: LONG @ $3969.99
        ìƒìŠ¹ ë°´ë“œì›Œí‚¹ í™•ì • (Score: 80)
14:55 - EXIT:  LONG @ $4020.78
        â†’ +$63.95 (+1.28%) âœ…
```

**ê°œì„  íš¨ê³¼**: ë°´ë“œì›Œí‚¹ ê°ì§€ í›„ ì¶”ì„¸ ì¶”ì¢…ìœ¼ë¡œ í° ìˆ˜ìµ ì‹¤í˜„

### Case 3: 08:15 ë°´ë“œì›Œí‚¹ ë°˜ì „ ì†ì ˆ ì™„í™” âœ…

**ì´ì „ (SL -1.0%)**:
```
08:15 - ENTRY: LONG @ $3928.33
08:20 - EXIT:  LONG @ $3880.29 â†’ -$61.23 (-1.22%) ì†ì ˆ
```

**í˜„ì¬ (SL -5.0%)**:
```
08:15 - ENTRY: LONG @ $3928.33
09:40 - EXIT:  LONG @ $3894.35 â†’ -$43.31 (-0.86%) ë°´ë“œì›Œí‚¹ ì¢…ë£Œ
```

**ê°œì„  íš¨ê³¼**: ë„“ì€ ì†ì ˆí­ìœ¼ë¡œ ë°´ë“œì›Œí‚¹ ì¢…ë£Œ ì‹œì ê¹Œì§€ ëŒ€ê¸°, ì†ì‹¤ -1.22% â†’ -0.86%

---

## âš ï¸ í˜„ì¬ ë°œê²¬ëœ ë¬¸ì œì 

### ë¬¸ì œ 1: ì¼ì‹œì  Pullbackì„ ë°´ë“œì›Œí‚¹ ì¢…ë£Œë¡œ ì˜¤íŒ ğŸ”´

**ë°œìƒ êµ¬ê°„**: UTC 21ì¼ 14:00~16:00

**ì‹¤ì œ ì°¨íŠ¸**:
- ê°€ê²©: 3872 â†’ 4093 (+5.7% ì—°ì† ìƒìŠ¹)
- ëª…ë°±í•œ ìƒìŠ¹ ë°´ë“œì›Œí‚¹ êµ¬ê°„

**ê°ì§€ê¸° íŒë‹¨**:
```
14:10 - Score: 85 (HIGH) âœ…
14:15 - Score: 80 (HIGH) âœ…
14:20 - Score: 80 (HIGH) âœ…
14:25 - Score: 40 (LOW) âŒ <- ì¼ì‹œì  í•˜ë½ìœ¼ë¡œ LOW íŒì •
14:30 - Score: 50 (MEDIUM)
14:35 - Score: 50 (MEDIUM)
14:40 - Score: 40 (LOW)
14:45 - Score: 80 (HIGH) âœ… <- ì¬ê°ì§€
```

**ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰**:
```
14:20 - ENTRY: LONG @ $3941.49
14:25 - EXIT:  LONG @ $3913.00 â†’ -$36.26 (-0.72%) ë°´ë“œì›Œí‚¹ ì¢…ë£Œ ì²­ì‚°
```

**ë†“ì¹œ ê¸°íšŒ**:
- 14:55: 4020 ë„ë‹¬ (+2.0%)
- 16:00: 4093 ë„ë‹¬ (+3.9%)

**ì›ì¸ ë¶„ì„**:
1. **14:25 pullback**: 3941 â†’ 3913 (-0.7% ì¼ì‹œì  í•˜ë½)
2. **RSI í•˜ë½**: 68.6 â†’ 56.8 (ê·¹ë‹¨ ì˜ì—­ ë²—ì–´ë‚¨)
3. **BB Width ë³€í™”ìœ¨ ê°ì†Œ**: ì´ì „ ëŒ€ë¹„ í™•ì¥ë¥  ë‚®ì•„ì§
4. **ì ìˆ˜ ê¸‰ë½**: 80 â†’ 40 (ë°´ë“œì›Œí‚¹ ì¢…ë£Œë¡œ íŒë‹¨)

**ê·¼ë³¸ ì›ì¸**:
- BB Widthë¥¼ **ì´ì „ ìº”ë“¤ê³¼ì˜ ë³€í™”ìœ¨**ë¡œë§Œ íŒë‹¨
- **ì ˆëŒ€ì ì¸ BB Width** ê³ ë ¤ ì•ˆ í•¨
- **ë°´ë“œì›Œí‚¹ ê´€ì„±(inertia)** ì—†ìŒ

---

## ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„ í•´ê²° ë°©ì•ˆ

### ë°©ì•ˆ 1: ë°´ë“œì›Œí‚¹ ê´€ì„±(Inertia) ì¶”ê°€

```dart
// ë°´ë“œì›Œí‚¹ ìƒíƒœ ì¶”ì 
class BandWalkingState {
  BandWalkingRisk currentRisk;
  int consecutiveHighFrames; // HIGH ìœ ì§€ ìº”ë“¤ ìˆ˜
  int framesInCooldown; // ì¿¨ë‹¤ìš´ ë‚¨ì€ ìº”ë“¤ ìˆ˜
}

// HIGH ë¦¬ìŠ¤í¬ ìµœì†Œ ìœ ì§€ ê¸°ê°„
const int MIN_HIGH_FRAMES = 3; // ìµœì†Œ 3ê°œ ìº”ë“¤ (15ë¶„)
const int COOLDOWN_FRAMES = 2; // HIGH ì¢…ë£Œ í›„ 2ê°œ ìº”ë“¤ ìœ ì˜ˆ
```

**ë¡œì§**:
1. HIGH ë¦¬ìŠ¤í¬ ì§„ì… ì‹œ `consecutiveHighFrames` ì¹´ìš´íŠ¸ ì‹œì‘
2. ì ìˆ˜ê°€ ë–¨ì–´ì ¸ë„ `MIN_HIGH_FRAMES` ë™ì•ˆ HIGH ìœ ì§€
3. HIGH ì¢…ë£Œ í›„ `COOLDOWN_FRAMES` ë™ì•ˆ ì¬ì§„ì… ì‰½ê²Œ ì„¤ì •

### ë°©ì•ˆ 2: BB Width ì ˆëŒ€ê°’ ì„ê³„ê°’ ì¶”ê°€

```dart
// BB Width ì ˆëŒ€ê°’ì´ ì¶©ë¶„íˆ í¬ë©´ ë°´ë“œì›Œí‚¹ìœ¼ë¡œ íŒë‹¨
final bbWidth = (bb.upper - bb.lower) / bb.middle;

if (bbWidth > 0.05) { // 5% ì´ìƒì´ë©´
  score += 20; // ì¶”ê°€ ì ìˆ˜
}
```

### ë°©ì•ˆ 3: ì¶”ì„¸ ì§€ì†ì„± í™•ì¸

```dart
// MACDì™€ RSIê°€ ê°™ì€ ë°©í–¥ ìœ ì§€ ì¤‘ì´ë©´ ì ìˆ˜ ìœ ì§€
if (macd.histogram > 0 && rsi > 55) {
  // ìƒìŠ¹ ì¶”ì„¸ ìœ ì§€ ì¤‘
  score += 10;
}
```

---

## ğŸ“ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

### íŒŒì¼ êµ¬ì¡°
```
lib/
â”œâ”€â”€ backtesting/
â”‚   â”œâ”€â”€ entry_strategy_v3.dart      # V3 ì „ëµ ë©”ì¸ ë¡œì§
â”‚   â””â”€â”€ position_tracker.dart       # í¬ì§€ì…˜ ì¶”ì 
â”œâ”€â”€ services/v3/
â”‚   â”œâ”€â”€ band_walking_detector.dart  # ë°´ë“œì›Œí‚¹ ê°ì§€ê¸° (ì¬ì¡°ì • ì™„ë£Œ)
â”‚   â””â”€â”€ breakout_classifier.dart    # ë¸Œë ˆì´í¬ì•„ì›ƒ ë¶„ë¥˜
â””â”€â”€ utils/
    â””â”€â”€ technical_indicators.dart   # BB, RSI, MACD ê³„ì‚°

scripts/
â”œâ”€â”€ simple_backtest_v3.dart        # ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰
â””â”€â”€ detailed_v3_log.dart           # í”„ë ˆì„ë³„ CSV ë¡œê·¸ ìƒì„±
```

### í•µì‹¬ ì½”ë“œ ìœ„ì¹˜

**ë°´ë“œì›Œí‚¹ ê°ì§€ ì ìˆ˜**: `lib/services/v3/band_walking_detector.dart:58-157`
- BB Width: 40ì 
- RSI ê·¹ë‹¨: 30ì 
- MACD: 20ì 
- ì—°ì† ë°´ë“œ ë°–: 10ì 
- Volume: 5ì 

**ë°©í–¥ íŒì •**: `lib/services/v3/band_walking_detector.dart:171-188`

**ì „ëµë³„ ì†ì ˆ**: `lib/backtesting/entry_strategy_v3.dart:368-385`
- ì¶”ì„¸ ì¶”ì¢…: -5.0%
- ì—­ì¶”ì„¸: -0.5%

**ì²­ì‚° ë¡œì§**: `lib/backtesting/entry_strategy_v3.dart:387-440`

---

## ğŸ”„ ë³€ê²½ ì´ë ¥

### 2025-10-22 08:20
- âœ… ë°´ë“œì›Œí‚¹ ê°ì§€ê¸° ì ìˆ˜ ì¬ì¡°ì • ì™„ë£Œ
- âœ… ë°©í–¥ íŒì • ë¡œì§ ê°œì„ 
- âœ… ì „ëµë³„ ì†ì ˆ/ìµì ˆ ì°¨ë³„í™”
- âœ… ë°±í…ŒìŠ¤íŠ¸ ìˆ˜ìµë¥  -1.01% â†’ -0.59% ê°œì„ 
- ğŸ”´ ì¼ì‹œì  pullback ì˜¤íŒ ë¬¸ì œ ë°œê²¬
- ğŸ“‹ ë°´ë“œì›Œí‚¹ ê´€ì„± ë¡œì§ í•„ìš”

### ë‹¤ìŒ ì‘ì—… ì˜ˆì •
1. ë°´ë“œì›Œí‚¹ ê´€ì„±(inertia) ë¡œì§ êµ¬í˜„
2. BB Width ì ˆëŒ€ê°’ ì„ê³„ê°’ ì¶”ê°€
3. ì¶”ì„¸ ì§€ì†ì„± í™•ì¸ ë¡œì§ ê°•í™”
4. ì¬ë°±í…ŒìŠ¤íŠ¸ ë° ì„±ëŠ¥ ê²€ì¦

---

## ğŸ“Œ ì°¸ê³ ì‚¬í•­

### íƒ€ì„ì¡´ ì£¼ì˜
- ëª¨ë“  ë¡œê·¸ëŠ” **UTC ê¸°ì¤€**
- í•œêµ­ ì‹œê°„(KST) = UTC + 9ì‹œê°„
- ì˜ˆ: UTC 14:00 = KST 23:00

### ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•
```bash
# ê°„ë‹¨ ë°±í…ŒìŠ¤íŠ¸
dart run scripts/simple_backtest_v3.dart

# ìƒì„¸ CSV ë¡œê·¸ ìƒì„±
dart run scripts/detailed_v3_log.dart

# ìƒì„±ëœ CSV ë¶„ì„
grep "2025-10-21T14:" v3_detailed_log_*.csv
```

### ì£¼ìš” ì§€í‘œ í•´ì„
- **BWScore 70+**: ë°´ë“œì›Œí‚¹ í™•ì • (ì¶”ì„¸ ì¶”ì¢…)
- **BWScore 50-69**: ë°´ë“œì›Œí‚¹ ìœ„í—˜ (ê´€ë§ ë˜ëŠ” ì¡°ì‹¬ìŠ¤ëŸ¬ìš´ ì§„ì…)
- **BWScore 30-49**: ì£¼ì˜ (ì—­ì¶”ì„¸ ê°€ëŠ¥)
- **BWScore 0-29**: ì •ìƒ (ì—­ì¶”ì„¸ ì„ í˜¸)

---

**ë**
