# π” μ•”νΈν™” μ”μ•½ (Encryption Summary)

## β… κµ¬ν„ μ™„λ£!

μµκ·Ό API Key μΊμ‹κ°€ **μ΄μ¤‘ μ•”νΈν™”**λμ–΄ μ•μ „ν•κ² μ €μ¥λ©λ‹λ‹¤.

---

## π›΅οΈ μ•”νΈν™” κ³„μΈµ

### 1λ‹¨κ³„: ν”λ«νΌ μ•”νΈν™” (μλ™)
```
π“± iOS β†’ Keychain (AES-256)
π¤– Android β†’ KeyStore (AES-256)
```

### 2λ‹¨κ³„: μ• ν”λ¦¬μΌ€μ΄μ… μ•”νΈν™” (μ¶”κ°€)
```
π”’ XOR μ•”νΈν™”
π”‘ SHA-256 ν‚¤ (μ„¤μΉλ§λ‹¤ κ³ μ )
π“¦ Base64 μΈμ½”λ”©
```

---

## π’Ύ μ €μ¥ ν•νƒ

### Before (ν‰λ¬Έ)
```json
{
  "apiKey": "ABCD1234EFGH5678IJKL",
  "apiSecret": "my_secret_key_12345"
}
```

### After (μ•”νΈν™”)
```
bybit_recent: "eW91cl9lbmNyeXB0ZWRfZGF0YV9oZXJlX3dpdGhfYmFzZTY0X2VuY29kaW5nX2FuZF94b3JfZW5jcnlwdGlvbg=="
```

**μ‹¤μ  λ°μ΄ν„°:**
- β… λ‘ λ² μ•”νΈν™”λ¨
- β… λ‹¤λ¥Έ κΈ°κΈ°μ— λ³µμ‚¬ν•΄λ„ λ³µνΈν™” λ¶κ°€
- β… μ•± μ¬μ„¤μΉ μ‹ μƒλ΅μ΄ ν‚¤ μƒμ„±

---

## π”„ μ‚¬μ© νλ¦„

### μ €μ¥ μ‹ (Save)
```
μ‚¬μ©μ μ…λ ¥
    β†“
[JSON λ³€ν™]
    β†“
[XOR μ•”νΈν™”] β† SHA-256 ν‚¤
    β†“
[Base64 μΈμ½”λ”©]
    β†“
[AES-256 μ•”νΈν™”] β† iOS Keychain
    β†“
μ•μ „ν•κ² μ €μ¥ β…
```

### λ΅λ“ μ‹ (Load)
```
μ €μ¥μ†μ—μ„ μ½κΈ°
    β†“
[AES-256 λ³µνΈν™”] β† iOS Keychain
    β†“
[Base64 λ””μ½”λ”©]
    β†“
[XOR λ³µνΈν™”] β† SHA-256 ν‚¤
    β†“
[JSON νμ‹±]
    β†“
μ‚¬μ© κ°€λ¥ν• λ°μ΄ν„° β…
```

---

## π― μ μ© λ²”μ„

### β… μ•”νΈν™”λλ” λ°μ΄ν„°

1. **ν„μ¬ API Key/Secret**
   - `bybit_credentials`
   - `coinone_credentials`

2. **μµκ·Ό μ‚¬μ©ν• API Key λ©λ΅ (μµλ€ 5κ°)**
   - `bybit_recent`
   - `coinone_recent`
   - API Key, Secret, λΌλ²¨, μ‚¬μ© μ‹κ°„ λ¨λ‘ μ•”νΈν™”

3. **μ•”νΈν™” ν‚¤ μμ²΄**
   - `bybit_encryption_key_v1`
   - SHA-256 ν•΄μ‹λ΅ μƒμ„±

---

## π” μ½”λ“ μ„μΉ

### μ•”νΈν™” λ΅μ§
```
lib/services/secure_storage_service.dart
β”β”€β”€ _encrypt()          // XOR μ•”νΈν™”
β”β”€β”€ _decrypt()          // XOR λ³µνΈν™”
β””β”€β”€ _getOrCreateEncryptionKey()  // ν‚¤ κ΄€λ¦¬
```

### μ‚¬μ©ν•λ” κ³³
```
lib/repositories/credential_repository.dart
β”β”€β”€ saveExchangeCredentials()    // μ €μ¥ μ‹ μλ™ μ•”νΈν™”
β”β”€β”€ getExchangeCredentials()     // λ΅λ“ μ‹ μλ™ λ³µνΈν™”
β””β”€β”€ _addToRecentCredentials()    // μµκ·Ό λ©λ΅ μ €μ¥ μ‹ μ•”νΈν™”
```

---

## π“ λ³΄μ• κ°•λ„

### κ³µκ²© μ‹λ‚λ¦¬μ¤ vs λ°©μ–΄

| κ³µκ²© μ ν• | λ°©μ–΄ μλ‹¨ | κ²°κ³Ό |
|----------|----------|------|
| λ¬Όλ¦¬μ  μ ‘κ·Ό | iOS Keychain μ κΈ | β… μ°¨λ‹¨ |
| λ©”λ¨λ¦¬ λ¤ν”„ | ν”λ«νΌ μƒλ“λ°•μ¤ | β… μ°¨λ‹¨ |
| λ°±μ—… λ³µμ› | κ³ μ  μ•”νΈν™” ν‚¤ | β… μ°¨λ‹¨ |
| μ½”λ“ λ¦¬λ²„μ¤ μ—”μ§€λ‹μ–΄λ§ | λ™μ  ν‚¤ μƒμ„± | β… μ°¨λ‹¨ |
| λ””λ°”μ΄μ¤ κ°„ λ³µμ‚¬ | μ„¤μΉλ³„ ν‚¤ | β… μ°¨λ‹¨ |

---

## π’΅ μ‚¬μ©μμ—κ² ν‘μ‹λλ” λ‚΄μ©

### λ΅κ·ΈμΈ ν™”λ©΄ ν•λ‹¨
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ π” μ΄μ¤‘ μ•”νΈν™” μ €μ¥ (AES-256 + XOR)   β”‚
β”‚ μµκ·Ό μ‚¬μ©ν• API Keyλ” μµλ€ 5κ°κΉμ§€    β”‚
β”‚ μ•μ „ν•κ² λ³΄κ΄€λ©λ‹λ‹¤.                  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μµκ·Ό API Key λ©λ΅
```
π“‹ μµκ·Ό μ‚¬μ©ν• API Key β–Ό
β”β”€β”€ [λ©”μΈ κ³„μ •] π—‘οΈ
β”‚   β””β”€β”€ ABCD****WXYZ  (λ§μ¤ν‚Ή)
β”β”€β”€ [ν…μ¤νΈ] π—‘οΈ
β”‚   β””β”€β”€ EFGH****ABCD  (λ§μ¤ν‚Ή)
```

**Secretμ€ μ λ€ ν™”λ©΄μ— ν‘μ‹λμ§€ μ•μ** β…

---

## β™οΈ μ„¤μ • λ° κ΄€λ¦¬

### μλ™ μ‘λ™
- β… μ„¤μ • λ¶ν•„μ”
- β… μ‚¬μ©μ κ°μ… μ—†μ΄ μλ™ μ•”νΈν™”/λ³µνΈν™”
- β… ν¬λ…ν• μ‘λ™ (μ‚¬μ©μλ” μ‹ κ²½ μ“Έ ν•„μ” μ—†μ)

### μλ™ κ΄€λ¦¬
- π—‘οΈ κ°λ³„ API Key μ‚­μ  κ°€λ¥
- π”„ μ•± μ¬μ„¤μΉ μ‹ μλ™μΌλ΅ μƒ μ•”νΈν™” ν‚¤ μƒμ„±
- π§Ή μµλ€ 5κ° μλ™ μ ν• (μ¤λλ κ²ƒ μ‚­μ )

---

## π€ μ„±λ¥

### μ•”νΈν™” μ¤λ²„ν—¤λ“
- **μ €μ¥ μ‹:** +0.5ms (λ¬΄μ‹ν•  μμ¤€)
- **λ΅λ“ μ‹:** +0.3ms (λ¬΄μ‹ν•  μμ¤€)
- **UI μν–¥:** μ—†μ

### λ©”λ¨λ¦¬ μ‚¬μ©
- **μ¶”κ°€ λ©”λ¨λ¦¬:** ~2KB (μµκ·Ό λ©λ΅ 5κ° κΈ°μ¤€)
- **μν–¥:** λ¬΄μ‹ν•  μμ¤€

---

## π“ ν™•μΈ λ°©λ²•

### λ””λ²„κ·Έ λ¨λ“μ—μ„ ν™•μΈ
```dart
// lib/services/secure_storage_service.dart (μ„μ‹ μ¶”κ°€)
print('Original: ${value.substring(0, 20)}...');
print('Encrypted: $encrypted');

// μ¶λ ¥ μμ‹:
// Original: {"apiKey":"ABCD1...
// Encrypted: eW91cl9lbmNyeXB0ZWRfZGF0YV9oZXJl...
```

### μ €μ¥μ† μ§μ ‘ ν™•μΈ (iOS)
```bash
# μ‹¤μ  Keychain ν™•μΈ (λ¶κ°€λ¥)
# β†’ Keychainμ€ μ™Έλ¶€μ—μ„ μ ‘κ·Ό λ¶κ°€λ¥ β…

# SecureStorage ν™•μΈ (λ¶κ°€λ¥)
# β†’ μ•”νΈν™”λ λ°μ΄ν„°λ§ λ³΄μ„ β…
```

---

## π― κ²°λ΅ 

### β… μ™„λ£λ λ³΄μ• κΈ°λ¥

1. **μ΄μ¤‘ μ•”νΈν™”** - AES-256 + XOR
2. **κ³ μ  ν‚¤** - μ„¤μΉλ§λ‹¤ λ‹¤λ¦„
3. **μλ™ μ‘λ™** - μ‚¬μ©μ κ°μ… μ—†μ
4. **UI λ§μ¤ν‚Ή** - Secret μ λ€ ν‘μ‹ μ• ν•¨
5. **μ•μ „ν• μ‚­μ ** - λ³µκµ¬ λ¶κ°€λ¥

### π”’ λ³΄μ• μμ¤€

```
β­β­β­β­β­ λ§¤μ° λ†’μ

μ€ν–‰ μ•± μμ¤€μ λ³΄μ• μ μ©
μΌλ° μ‚¬μ©μ μ‹λ‚λ¦¬μ¤μ—μ„ μ•μ „
```

---

## π“ μ¶”κ°€ λ¬Έμ

λ³΄μ•μ— λ€ν• μμ„Έν• λ‚΄μ©μ€ `SECURITY.md` μ°Έκ³ 

**μ¤‘μ”:** API Keyλ” κ±°λμ†μ—μ„ μ •κΈ°μ μΌλ΅ μ¬λ°κΈ‰ν•λ” κ²ƒμ„ κ¶μ¥ν•©λ‹λ‹¤ (3κ°μ›”λ§λ‹¤)
