# ğŸ¯ ì „ëµ V4 - ì‹œì¥ ì ì‘í˜• ì „ëµ (Adaptive Market Strategy)

## ğŸ’¡ í•µì‹¬ ì•„ì´ë””ì–´

**"ì¶”ì„¸ì— ìˆœì‘í•˜ê³ , ì—­ì¶”ì„¸ëŠ” ì—„ê²©í•˜ê²Œ"**

### V3ì˜ ë¬¸ì œì 
```
âŒ SHORTë§Œ í•­ìƒ ì—„ê²© â†’ í•˜ë½ì¥ì—ì„œë„ ë¶ˆë¦¬
âŒ LONGë§Œ í•­ìƒ ì™„í™” â†’ ìƒìŠ¹ì¥ì—ì„œë§Œ ìœ ë¦¬
âŒ ì‹œì¥ ë¬´ì‹œí•˜ê³  ê³ ì • ì¡°ê±´ ì‚¬ìš©
```

### V4ì˜ í•´ê²°ì±…
```
âœ… ë´‡ ì‹œì‘ ì‹œ ì¶”ì„¸ ë¶„ì„ (100-200 ìº”ë“¤)
âœ… ì¶”ì„¸ ë°©í–¥ì— ë§ëŠ” ì „ëµ ì„ íƒ
âœ… ìˆœì¶”ì„¸ ì§„ì… ì™„í™”, ì—­ì¶”ì„¸ ì§„ì… ì—„ê²©í™”
âœ… íš¡ë³´ì¥ ì „ìš© ì „ëµ ì¶”ê°€
```

---

## ğŸ“Š ì‹œì¥ ì¶”ì„¸ íŒë³„ ë¡œì§

### ë¶„ì„ ê¸°ì¤€
```dart
// ë´‡ ì‹œì‘ ì‹œ í•œ ë²ˆë§Œ ë¶„ì„
ìº”ë“¤ ìˆ˜: 200ê°œ (5ë¶„ë´‰ = 16ì‹œê°„ 40ë¶„)
ë¶„ì„ ë°©ë²•: ì„ í˜• íšŒê·€ ë˜ëŠ” ë‹¨ìˆœ ê°€ê²© ë¹„êµ
```

### ì¶”ì„¸ ë¶„ë¥˜
```dart
final startPrice = candles[0].close;
final endPrice = candles[199].close;
final priceChange = ((endPrice - startPrice) / startPrice) * 100;

if (priceChange > 1.0) {
  marketTrend = MarketTrend.uptrend;      // ìƒìŠ¹ì¥
} else if (priceChange < -1.0) {
  marketTrend = MarketTrend.downtrend;    // í•˜ë½ì¥
} else {
  marketTrend = MarketTrend.sideways;     // íš¡ë³´ì¥
}
```

### ì¶”ì„¸ë³„ ê¸°ì¤€ê°’
```
ìƒìŠ¹ì¥:  +1.0% ì´ìƒ ìƒìŠ¹
í•˜ë½ì¥:  -1.0% ì´ìƒ í•˜ë½
íš¡ë³´ì¥:  -1.0% ~ +1.0%
```

---

## ğŸ¯ ì¶”ì„¸ë³„ ì „ëµ ì„¤ì •

### ğŸ“ˆ ìƒìŠ¹ì¥ (Uptrend)

#### ì „ëµ: **LONG ì ê·¹, SHORT ë³´ìˆ˜**

```dart
LONG ì¡°ê±´ (ì™„í™”):
âœ“ RSI6 < 30
âœ“ RSI14: 30-50
âœ“ ê±°ë˜ëŸ‰ > í‰ê·  Ã— 1.5   // 2.0 â†’ 1.5 ì™„í™”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3/3 ì¡°ê±´ ì¶©ì¡± ì‹œ ì§„ì…

SHORT ì¡°ê±´ (ì—„ê²©):
âœ“ RSI6 > 85             // 80 â†’ 85 ê°•í™”
âœ“ RSI14: 50-70
âœ“ ê±°ë˜ëŸ‰ > í‰ê·  Ã— 3.5   // 3.0 â†’ 3.5 ê°•í™”
âœ“ ë‹¨ê¸° í•˜ë½ í™•ì¸ í•„ìˆ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4/4 ì¡°ê±´ ì¶©ì¡± ì‹œ ì§„ì…
```

#### ë…¼ë¦¬
- ìƒìŠ¹ ì¶”ì„¸ = LONGì´ ìœ ë¦¬ â†’ ì§„ì… ì‰½ê²Œ
- ì—­ì¶”ì„¸ SHORT = ìœ„í—˜ â†’ ê·¹ë„ë¡œ ì—„ê²©

---

### ğŸ“‰ í•˜ë½ì¥ (Downtrend)

#### ì „ëµ: **SHORT ì ê·¹, LONG ë³´ìˆ˜**

```dart
LONG ì¡°ê±´ (ì—„ê²©):
âœ“ RSI6 < 25             // 30 â†’ 25 ê°•í™”
âœ“ RSI14: 30-50
âœ“ ê±°ë˜ëŸ‰ > í‰ê·  Ã— 3.0   // 2.0 â†’ 3.0 ê°•í™”
âœ“ ë‹¨ê¸° ë°˜ë“± í™•ì¸ í•„ìˆ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4/4 ì¡°ê±´ ì¶©ì¡± ì‹œ ì§„ì…

SHORT ì¡°ê±´ (ì™„í™”):
âœ“ RSI6 > 75             // 80 â†’ 75 ì™„í™”
âœ“ RSI14: 50-70
âœ“ ê±°ë˜ëŸ‰ > í‰ê·  Ã— 2.0   // 3.0 â†’ 2.0 ì™„í™”
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3/3 ì¡°ê±´ ì¶©ì¡± ì‹œ ì§„ì…
```

#### ë…¼ë¦¬
- í•˜ë½ ì¶”ì„¸ = SHORTê°€ ìœ ë¦¬ â†’ ì§„ì… ì‰½ê²Œ
- ì—­ì¶”ì„¸ LONG = ìœ„í—˜ â†’ ê·¹ë„ë¡œ ì—„ê²©

---

### ğŸ“Š íš¡ë³´ì¥ (Sideways)

#### ì „ëµ: **ì–‘ë°©í–¥ ë³´ìˆ˜, ë³¼ë¦°ì € ë°´ë“œ í™œìš©**

```dart
LONG ì¡°ê±´ (ì¤‘ê°„):
âœ“ RSI6 < 25             // ê³¼ë§¤ë„ ê·¹ì‹¬
âœ“ RSI14: 30-50
âœ“ ê±°ë˜ëŸ‰ > í‰ê·  Ã— 2.5
âœ“ ë³¼ë¦°ì € í•˜ë‹¨ í„°ì¹˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4/4 ì¡°ê±´ ì¶©ì¡± ì‹œ ì§„ì…

SHORT ì¡°ê±´ (ì¤‘ê°„):
âœ“ RSI6 > 75             // ê³¼ì—´ ê·¹ì‹¬
âœ“ RSI14: 50-70
âœ“ ê±°ë˜ëŸ‰ > í‰ê·  Ã— 2.5
âœ“ ë³¼ë¦°ì € ìƒë‹¨ í„°ì¹˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4/4 ì¡°ê±´ ì¶©ì¡± ì‹œ ì§„ì…
```

#### ë…¼ë¦¬
- íš¡ë³´ì¥ = ë°©í–¥ì„± ì—†ìŒ â†’ ì–‘ìª½ ëª¨ë‘ ì—„ê²©
- ë°´ë“œ í„°ì¹˜ = ë°˜ì „ í™•ë¥  ë†’ìŒ â†’ í‰ê·  íšŒê·€ ì „ëµ
- ê±°ë˜ëŸ‰ í•„ìˆ˜ = ê°€ì§œ ì‹ í˜¸ ë°°ì œ

#### ë³¼ë¦°ì € ë°´ë“œ ì¡°ê±´
```dart
// í•˜ë‹¨ í„°ì¹˜ (LONG)
currentPrice <= bollingerLower * 1.002  // í•˜ë‹¨ 0.2% ì´ë‚´

// ìƒë‹¨ í„°ì¹˜ (SHORT)
currentPrice >= bollingerUpper * 0.998  // ìƒë‹¨ 0.2% ì´ë‚´
```

---

## ğŸ“‹ ì „ëµ ë¹„êµí‘œ

| ì¡°ê±´ | ìƒìŠ¹ì¥ | í•˜ë½ì¥ | íš¡ë³´ì¥ |
|------|--------|--------|--------|
| **LONG RSI6** | < 30 | < 25 âš ï¸ | < 25 âš ï¸ |
| **LONG ê±°ë˜ëŸ‰** | Ã— 1.5 âœ… | Ã— 3.0 âš ï¸ | Ã— 2.5 |
| **LONG ì¶”ê°€** | - | ë°˜ë“± í™•ì¸ | BB í•˜ë‹¨ |
| **SHORT RSI6** | > 85 âš ï¸ | > 75 âœ… | > 75 |
| **SHORT ê±°ë˜ëŸ‰** | Ã— 3.5 âš ï¸ | Ã— 2.0 âœ… | Ã— 2.5 |
| **SHORT ì¶”ê°€** | ë‹¨ê¸° í•˜ë½ | - | BB ìƒë‹¨ |

âœ… = ì™„í™” (ì§„ì… ì‰¬ì›€)
âš ï¸ = ì—„ê²© (ì§„ì… ì–´ë ¤ì›€)

---

## ğŸ”„ ì¶”ì„¸ ì¬ë¶„ì„ ì£¼ê¸°

### ì˜µì…˜ 1: ë´‡ ì‹œì‘ ì‹œ 1íšŒë§Œ
```dart
ì¥ì : ì„±ëŠ¥ ì¢‹ìŒ, ì¼ê´€ì„± ìœ ì§€
ë‹¨ì : ì¥ì¤‘ ì¶”ì„¸ ë³€í™” ë¯¸ë°˜ì˜
ì¶”ì²œ: ë‹¨ê¸° íŠ¸ë ˆì´ë”© (1-3ì‹œê°„)
```

### ì˜µì…˜ 2: ì£¼ê¸°ì  ì¬ë¶„ì„
```dart
ì£¼ê¸°: 1ì‹œê°„ë§ˆë‹¤
ì¥ì : ì¶”ì„¸ ë³€í™” ëŒ€ì‘
ë‹¨ì : ì „ëµ ìì£¼ ë³€ê²½ â†’ í˜¼ë€
ì¶”ì²œ: ì¥ê¸° ìš´ì˜ (24ì‹œê°„+)
```

### ì˜µì…˜ 3: ì†ìµ ê¸°ë°˜ ì¬ë¶„ì„
```dart
íŠ¸ë¦¬ê±°: ì—°ì† 3íšŒ ì†ì‹¤ ì‹œ
ì¥ì : ì „ëµ ë¯¸ìŠ¤ë§¤ì¹˜ ê°ì§€
ë‹¨ì : ì†ì‹¤ í›„ ëŒ€ì‘ (ëŠ¦ìŒ)
ì¶”ì²œ: ì•ˆì „ ì¤‘ì‹œ
```

**ê¶Œì¥: ì˜µì…˜ 1 (ë´‡ ì‹œì‘ ì‹œ 1íšŒ) + ìˆ˜ë™ ì¬ì‹œì‘**

---

## ğŸ¯ íš¡ë³´ì¥ ì „ëµ ìƒì„¸

### ì™œ ë³¼ë¦°ì € ë°´ë“œ?
```
íš¡ë³´ì¥ íŠ¹ì§•:
- ì¼ì • ë²”ìœ„ ë‚´ ë“±ë½ ë°˜ë³µ
- ì¶”ì„¸ ì—†ìŒ â†’ RSIë§Œìœ¼ë¡œ ë¶€ì¡±
- í‰ê·  íšŒê·€ ì„±í–¥ ê°•í•¨

ë³¼ë¦°ì € ë°´ë“œ:
- ìƒë‹¨ í„°ì¹˜ â†’ ê³¼ë§¤ìˆ˜ â†’ í•˜ë½ ê°€ëŠ¥ì„±
- í•˜ë‹¨ í„°ì¹˜ â†’ ê³¼ë§¤ë„ â†’ ìƒìŠ¹ ê°€ëŠ¥ì„±
- í†µê³„ì  ê·¼ê±° (í‘œì¤€í¸ì°¨ 2Ïƒ)
```

### ë³¼ë¦°ì € ì„¤ì •
```dart
ê¸°ê°„: 20 (5ë¶„ë´‰ = 100ë¶„)
í‘œì¤€í¸ì°¨: 2.0
í„°ì¹˜ í—ˆìš© ì˜¤ì°¨: Â±0.2%
```

### ì§„ì… ì˜ˆì‹œ
```
LONG ì§„ì… (íš¡ë³´ì¥):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
í˜„ì¬ê°€: $3,850
ë³¼ë¦°ì € í•˜ë‹¨: $3,855
ìƒë‹¨: $3,945
ì¤‘ê°„ì„ : $3,900

ì¡°ê±´:
âœ“ ê°€ê²© í•˜ë‹¨ í„°ì¹˜: $3,850 â‰¤ $3,855 Ã— 1.002
âœ“ RSI6: 24 (< 25)
âœ“ RSI14: 42 (30-50 ë²”ìœ„)
âœ“ ê±°ë˜ëŸ‰: í‰ê·  Ã— 2.8

â†’ LONG ì§„ì… âœ…
ëª©í‘œ: ì¤‘ê°„ì„  $3,900 (+1.3%)
```

---

## ğŸ’» êµ¬í˜„ êµ¬ì¡°

### 1. MarketTrend Enum ì¶”ê°€
```dart
enum MarketTrend {
  uptrend,    // ìƒìŠ¹ì¥: +1.0% ì´ìƒ
  downtrend,  // í•˜ë½ì¥: -1.0% ì´í•˜
  sideways,   // íš¡ë³´ì¥: -1.0% ~ +1.0%
  unknown,    // ë¶„ì„ ì „
}
```

### 2. TradingProviderì— ì¶”ê°€
```dart
MarketTrend _currentTrend = MarketTrend.unknown;
DateTime? _trendAnalyzedAt;

// ë´‡ ì‹œì‘ ì‹œ í˜¸ì¶œ
Future<void> _analyzeMarketTrend() async {
  final candles = await fetchCandles(limit: 200);
  _currentTrend = _determineTrend(candles);
  _trendAnalyzedAt = DateTime.now();
}
```

### 3. ì¡°ê±´ ë™ì  ì„¤ì •
```dart
double getLongRsi6Threshold() {
  switch (_currentTrend) {
    case MarketTrend.uptrend: return 30.0;
    case MarketTrend.downtrend: return 25.0;
    case MarketTrend.sideways: return 25.0;
    default: return 30.0;
  }
}

double getLongVolumeMultiplier() {
  switch (_currentTrend) {
    case MarketTrend.uptrend: return 1.5;
    case MarketTrend.downtrend: return 3.0;
    case MarketTrend.sideways: return 2.5;
    default: return 2.0;
  }
}
```

### 4. ë³¼ë¦°ì € ë°´ë“œ ê³„ì‚° (íš¡ë³´ì¥)
```dart
if (_currentTrend == MarketTrend.sideways) {
  final bb = calculateBollingerBands(candles, period: 20);
  bool longBbCondition = currentPrice <= bb.lower * 1.002;
  bool shortBbCondition = currentPrice >= bb.upper * 0.998;
}
```

---

## ğŸ“Š ì˜ˆìƒ ì„±ê³¼

### V3 (SHORTë§Œ ì—„ê²©)
```
ìƒìŠ¹ì¥: LONG 50% â†’ ì¢‹ìŒ âœ…
í•˜ë½ì¥: SHORT ì°¨ë‹¨ â†’ ë‚˜ì¨ âŒ
íš¡ë³´ì¥: ë‘˜ ë‹¤ ì¤‘ê°„ â†’ ë³´í†µ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ë²”ìš©ì„±: ì¤‘ê°„
```

### V4 (ì‹œì¥ ì ì‘í˜•)
```
ìƒìŠ¹ì¥: LONG 60% â†’ ë” ì¢‹ìŒ âœ…
í•˜ë½ì¥: SHORT 60% â†’ ì¢‹ìŒ âœ…
íš¡ë³´ì¥: í‰ê· íšŒê·€ 50% â†’ ì•ˆì • âœ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ë²”ìš©ì„±: ë†’ìŒ âœ…âœ…
```

---

## ğŸš¨ ë¦¬ìŠ¤í¬ ê´€ë¦¬

### 1. ì¶”ì„¸ ì˜¤íŒ
```
ë¬¸ì œ: ìƒìŠ¹ì¥ì„ í•˜ë½ì¥ìœ¼ë¡œ ì˜ëª» íŒë‹¨
ëŒ€ì±…: 200 ìº”ë“¤ ì‚¬ìš© (ì¶©ë¶„í•œ ë°ì´í„°)
      ìˆ˜ë™ í™•ì¸ ê°€ëŠ¥í•˜ë„ë¡ UIì— í‘œì‹œ
```

### 2. ì¶”ì„¸ ê¸‰ë³€
```
ë¬¸ì œ: ë¶„ì„ í›„ ì‹œì¥ ê¸‰ë³€
ëŒ€ì±…: ì—°ì† ì†ì‹¤ 3íšŒ ì‹œ ê²½ê³ 
      ìˆ˜ë™ ì¬ì‹œì‘ ê¶Œì¥
```

### 3. íš¡ë³´ì¥ ê°€ì§œ ì‹ í˜¸
```
ë¬¸ì œ: ë³¼ë¦°ì € í„°ì¹˜ í›„ ê³„ì† í•˜ë½
ëŒ€ì±…: RSI + ê±°ë˜ëŸ‰ í•„ìˆ˜ ì¡°ê±´
      TP/SL íƒ€ì´íŠ¸í•˜ê²Œ ìœ ì§€
```

---

## ğŸ¯ UI ê°œì„  í•„ìš”ì‚¬í•­

### 1. í˜„ì¬ ì¶”ì„¸ í‘œì‹œ
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š ì‹œì¥ ë¶„ì„
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì¶”ì„¸: ğŸ“ˆ ìƒìŠ¹ì¥ (+2.3%)
ë¶„ì„: 200 ìº”ë“¤ (16h 40m)
ì‹œê°: 2025-10-19 14:30
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
LONG: ì™„í™” (RSI < 30, Vol Ã— 1.5)
SHORT: ì—„ê²© (RSI > 85, Vol Ã— 3.5)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### 2. ì¬ë¶„ì„ ë²„íŠ¼
```
[ğŸ”„ ì¶”ì„¸ ì¬ë¶„ì„]
```

### 3. ì¶”ì„¸ë³„ í†µê³„
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š ì¶”ì„¸ë³„ ì„±ê³¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ìƒìŠ¹ì¥: 12 ê±°ë˜ | ìŠ¹ë¥  58%
í•˜ë½ì¥: 8 ê±°ë˜ | ìŠ¹ë¥  62%
íš¡ë³´ì¥: 5 ê±°ë˜ | ìŠ¹ë¥  40%
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ğŸ”§ AppConstants ì¶”ê°€ í•„ìš”

```dart
// Market Trend Analysis
static const int trendAnalysisCandleCount = 200;
static const double trendUptrendThreshold = 1.0;      // +1.0%
static const double trendDowntrendThreshold = -1.0;   // -1.0%

// Uptrend Settings
static const double uptrendLongRsi6 = 30.0;
static const double uptrendLongVolume = 1.5;
static const double uptrendShortRsi6 = 85.0;
static const double uptrendShortVolume = 3.5;

// Downtrend Settings
static const double downtrendLongRsi6 = 25.0;
static const double downtrendLongVolume = 3.0;
static const double downtrendShortRsi6 = 75.0;
static const double downtrendShortVolume = 2.0;

// Sideways Settings
static const double sidewaysLongRsi6 = 25.0;
static const double sidewaysLongVolume = 2.5;
static const double sidewaysShortRsi6 = 75.0;
static const double sidewaysShortVolume = 2.5;
static const bool sidewaysUseBollingerBands = true;
static const int sidewaysBollingerPeriod = 20;
static const double sidewaysBollingerStdDev = 2.0;
static const double sidewaysBollingerTouchTolerance = 0.002; // 0.2%
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### êµ¬í˜„
- [ ] MarketTrend enum ì¶”ê°€
- [ ] ì¶”ì„¸ ë¶„ì„ ë¡œì§ êµ¬í˜„
- [ ] ì¶”ì„¸ë³„ ì¡°ê±´ getter í•¨ìˆ˜
- [ ] ë³¼ë¦°ì € ë°´ë“œ ê³„ì‚° (íš¡ë³´ì¥)
- [ ] UIì— ì¶”ì„¸ í‘œì‹œ
- [ ] ì¬ë¶„ì„ ë²„íŠ¼ ì¶”ê°€

### í…ŒìŠ¤íŠ¸
- [ ] ìƒìŠ¹ì¥ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
- [ ] í•˜ë½ì¥ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
- [ ] íš¡ë³´ì¥ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
- [ ] ì¶”ì„¸ ì „í™˜ ì‹œ ë™ì‘ í™•ì¸

---

## ğŸš€ ë§ˆì´ê·¸ë ˆì´ì…˜

### V3 â†’ V4
```
1. AppConstants ì—…ë°ì´íŠ¸
2. TradingProvider ìˆ˜ì •
3. UI ì¶”ì„¸ í‘œì‹œ ì¶”ê°€
4. ê¸°ì¡´ ì„¤ì • í˜¸í™˜ì„± ìœ ì§€
```

---

**ë²„ì „**: V4 (Adaptive Market Strategy)
**ì² í•™**: "ì‹œì¥ì„ ì´ê¸°ì§€ ë§ê³ , ì‹œì¥ì„ ë”°ë¼ê°€ë¼"
**í•µì‹¬**: ìˆœì¶”ì„¸ ì ê·¹, ì—­ì¶”ì„¸ ë³´ìˆ˜, íš¡ë³´ì¥ í‰ê· íšŒê·€
**ìƒíƒœ**: ì„¤ê³„ ì™„ë£Œ, êµ¬í˜„ ëŒ€ê¸°
