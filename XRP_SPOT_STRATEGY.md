# XRP 현물 스캘핑 전략 (Coinone)

## 전략 개요

**거래 유형**: 현물 (Spot) - 롱 포지션만 가능
**수수료**: 0.02% per trade (Coinone)
**타임프레임**: 5분봉
**목표**: 단기 변동성을 활용한 스캘핑

---

## 핵심 로직

### 1. 추세 필터 (Uptrend Filter) - 필수

현물 거래는 롱 포지션만 가능하므로 **상승장에서만 진입**해야 합니다.

```
추세 판단: EMA50 > EMA200 → 상승장
```

- **EMA50**: 50기간 지수이동평균 (중기 추세)
- **EMA200**: 200기간 지수이동평균 (장기 추세)
- EMA50이 EMA200 위에 있으면 → 상승 추세 확인
- 하락장(EMA50 ≤ EMA200)에서는 **진입 금지**

---

### 2. 진입 조건 (Entry Signals)

**모든 조건을 동시에 만족**해야 진입:

```
✅ 상승장 필터: EMA50 > EMA200
AND
✅ 과매도 신호: (RSI < 35) OR (현재가 ≤ 볼린저 하단밴드)
AND
✅ 단기 모멘텀: EMA9 > EMA9(이전)
```

#### 각 조건 설명:

1. **RSI < 35**: 상대강도지수가 35 미만 → 과매도 상태 → 반등 가능성
2. **가격 ≤ 볼린저 하단**: 평균 회귀 전략 → 하단에서 매수, 중간으로 회귀 기대
3. **EMA9 상승 추세**: 단기 이동평균이 전 캔들보다 상승 → 즉각적 모멘텀 확인

**진입 시점 예시**:
```
시간: 2025-10-19 12:50:00
가격: 3,597 KRW
EMA50: 3,593.26 (상승장 확인 ✓)
EMA200: 3,588.29
RSI: 34.04 (과매도 ✓)
EMA9 상승 중 ✓
→ 진입!
```

---

### 3. 청산 조건 (Exit Signals)

**다음 중 하나라도 만족하면 즉시 청산**:

```
❌ RSI > 65 (과매수)
OR
❌ 현재가 ≥ 볼린저 상단밴드 (평균 회귀 완료)
OR
❌ Stop Loss: 현재가 ≤ 진입가 × 0.98 (2% 손절)
OR
❌ 추세 반전: EMA50 ≤ EMA200 (하락 전환)
```

#### 각 조건 설명:

1. **RSI > 65**: 과매수 영역 → 조정 가능성 → 익절
2. **볼린저 상단 도달**: 평균 회귀 목표 달성 → 익절
3. **2% 손절**: 진입가 대비 2% 하락 시 강제 청산 → 손실 제한
4. **추세 반전**: 상승장이 끝나면 즉시 청산 → 추가 하락 방지

**청산 시점 예시**:
```
시간: 2025-10-19 13:20:00
가격: 3,603 KRW
진입가: 3,597 KRW
볼린저 상단 도달 → 청산!
수익: +158 KRW (수수료 차감 후)
```

---

## 백테스트 결과

### 테스트 조건
- **기간**: 2025-10-18 23:10 ~ 2025-10-19 15:45 (약 16시간, 200개 5분봉)
- **초기 자본**: 100,000 KRW
- **포지션 크기**: 95% (자본의 95% 사용)
- **수수료**: 0.02% per trade

### 전략별 성과

| 전략 | 거래 수 | 승률 | 수익률 | 총 손익 |
|------|---------|------|--------|---------|
| Bollinger Bands | 7 | 57.1% | -29.81% | -29,815 KRW |
| RSI | 3 | 100% | -12.67% | -12,674 KRW |
| EMA Crossover | 5 | 60.0% | -22.54% | -22,541 KRW |
| **Combined (Uptrend)** | **1** | **100%** | **-4.88%** | **-4,880 KRW** |

### 분석

**✅ 개선점**:
1. **거래 빈도 감소**: 추세 필터로 무분별한 진입 방지 (1회만 거래)
2. **손실 최소화**: -4.88% (다른 전략 대비 60-80% 손실 감소)
3. **승률 100%**: 단 1회 거래이지만 손절 없이 목표가 달성

**⚠️ 한계점**:
1. **테스트 기간 부족**: 16시간은 통계적으로 유의미하지 않음 (최소 30일 필요)
2. **하락장 데이터**: 테스트 기간이 전반적으로 하락/횡보장 → 진입 기회 제한
3. **수익 미발생**: 모든 전략이 손실 → 시장 상황이 불리했음

---

## 전략의 장단점

### ✅ 장점

1. **현물 특성 반영**: 롱만 가능한 현물의 제약을 추세 필터로 해결
2. **리스크 관리**:
   - 상승장만 진입 → 대세 하락 회피
   - 2% 손절 → 큰 손실 방지
   - 추세 반전 시 즉시 청산
3. **다중 신호 확인**: RSI + 볼린저밴드 + EMA 조합으로 신뢰도 향상
4. **과최적화 방지**: 단순하고 명확한 규칙

### ❌ 단점

1. **보수적 진입**: 상승장 필터로 인해 거래 기회 감소
2. **횡보장 취약**: 추세가 명확하지 않으면 진입 불가
3. **단기 데이터 한계**: 장기 추세(EMA200)가 안정화되려면 시간 필요
4. **수수료 민감**: 스캘핑은 수수료가 수익에 큰 영향 (0.02% × 2 = 0.04%)

---

## 실전 적용 시 권장사항

### 1. 데이터 기반 검증
```bash
# 최소 30일 이상 백테스트 권장
python3 coinone_xrp_backtest.py
```

### 2. 파라미터 최적화

현재 설정:
- RSI 진입: 35 (과매도)
- RSI 청산: 65 (과매수)
- 볼린저 밴드: 20기간, 2 표준편차
- 손절: 2%

최적화 후보:
- RSI 범위: 30-40 (진입), 60-70 (청산)
- 손절 범위: 1.5% ~ 3%
- 볼린저 표준편차: 1.5 ~ 2.5

### 3. 시장 상황 모니터링

- **상승장**: 적극 운용 (EMA50 > EMA200 지속)
- **하락장**: 거래 중단 또는 대기
- **급등/급락**: 변동성 확대 시 손절폭 조정 고려

### 4. 자본 관리

- 포지션 크기: 자본의 50-95% (리스크 성향에 따라)
- 최대 손실 한도: 일일 -5%, 주간 -10%
- 연속 손실 시 거래 중단 규칙

---

## 코드 구현 예시

```python
# 진입 조건 체크
def check_entry_signal(df, i):
    # 추세 필터
    if df.loc[i, 'EMA_50'] <= df.loc[i, 'EMA_200']:
        return False  # 하락장 → 진입 금지

    # 과매도 신호
    rsi_signal = df.loc[i, 'RSI'] < 35
    bb_signal = df.loc[i, 'Close'] <= df.loc[i, 'BB_Lower'] * 1.002

    # 단기 모멘텀
    ema_up = df.loc[i, 'EMA_9'] > df.loc[i-1, 'EMA_9']

    return (rsi_signal or bb_signal) and ema_up

# 청산 조건 체크
def check_exit_signal(df, i, entry_price):
    close = df.loc[i, 'Close']

    # 익절 조건
    rsi_exit = df.loc[i, 'RSI'] > 65
    bb_exit = close >= df.loc[i, 'BB_Upper'] * 0.998

    # 손절 조건
    stop_loss = close <= entry_price * 0.98

    # 추세 반전
    trend_reversal = df.loc[i, 'EMA_50'] <= df.loc[i, 'EMA_200']

    return rsi_exit or bb_exit or stop_loss or trend_reversal
```

---

## 결론

이 전략은 **현물의 제약(롱만 가능)**을 **추세 필터(EMA50/200)**로 극복하는 것이 핵심입니다.

- **상승장 진입**: 큰 손실 방지
- **과매도 매수**: 반등 포착
- **명확한 손절**: 리스크 제한
- **다중 신호**: 신뢰도 향상

하지만 **충분한 백테스트(최소 30일)** 없이는 실전 투입을 권장하지 않습니다. 현재 16시간 테스트로는 통계적 유의성이 부족합니다.

**다음 단계**:
1. 더 긴 기간 데이터 확보 (코인원 API 제한 해결)
2. 다양한 시장 상황(상승/하락/횡보)에서 검증
3. 파라미터 최적화 (RSI, 손절, 볼린저 등)
4. 소액 실전 테스트 → 점진적 확대
